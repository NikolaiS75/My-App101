# -*- coding: utf-8 -*-
"""
Created on Wed Oct 30 09:33:08 2019

@author: g90c
"""
import pandas as pd
import numpy as np
from catboost import Pool, CatBoostRegressor

import time


# initialize data
sz=1000000
data_trn =pd.DataFrame(np.random.normal(0, 100, size=(sz, 1000)))
data_tst =pd.DataFrame(np.random.normal(0, 100, size=(100, 1000)))

y_trn= pd.DataFrame(np.random.normal(0, 1000, size=(sz ,1)))
y_tst= pd.DataFrame(np.random.normal(0, 1000, size=(100,1)))

start_time = time.time()
# initialize Pool
#train_pool = Pool(train_data, train_label, cat_features=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])
#test_pool = Pool(test_data, cat_features=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]) 
#model = CatBoostRegressor(iterations=20, depth=12, learning_rate=.1, task_type='GPU', loss_function='RMSE', border_count=64)
model = CatBoostRegressor(iterations=20, depth=12, learning_rate=.1, task_type='CPU', loss_function='RMSE')
#train the model
model.fit(data_trn,  y_trn, eval_set=(data_tst,  y_tst))
# make the prediction using the resulting model
preds = model.predict(data_tst)
print("--- %s seconds ---" % (time.time() - start_time))
#print(preds)

import pandas as pd
target=['HSL_adj']
used_feature_lgb=['DoY', 'DoM', 'DoW', 'DoY_sin', 'DoY_cos', 'DoW_sin', 'DoW_cos', 'Mid_sin', 'Mid_cos', 'Hour_sin', 'Hour_cos', 'daylight_dur', 'delta_sunset', 'delta_sunrise', 'ws_K11R', 'ws_K3T5', 'ws_K6R6', 'ws_KABI', 'ws_KACT', 'ws_KADS', 'ws_KAFW', 'ws_KALI', 'ws_KAMA', 'ws_KAPY', 'ws_KAQO', 'ws_KARM', 'ws_KASL', 'ws_KATT', 'ws_KAUS', 'ws_KAXH', 'ws_KBAZ', 'ws_KBBD', 'ws_KBBF', 'ws_KBEA', 'ws_KBGD', 'ws_KBIF', 'ws_KBKD', 'ws_KBKS', 'ws_KBMQ', 'ws_KBMT', 'ws_KBPC', 'ws_KBPG', 'ws_KBPT', 'ws_KBQX', 'ws_KBRO', 'ws_KBWD', 'ws_KBYY', 'ws_KCDS', 'ws_KCLL', 'ws_KCNW', 'ws_KCOM', 'ws_KCOT', 'ws_KCPT', 'ws_KCRH', 'ws_KCRP', 'ws_KCRS', 'ws_KCWC', 'ws_KCXO', 'ws_KDAL', 'ws_KDFW', 'ws_KDHT', 'ws_KDKR', 'ws_KDLF', 'ws_KDRT', 'ws_KDTO', 'ws_KDUX', 'ws_KDWH', 'ws_KDYS', 'ws_KDZB', 'ws_KE38', 'ws_KEBG', 'ws_KECU', 'ws_KEDC', 'ws_KEFD', 'ws_KELP', 'ws_KEMK', 'ws_KERV', 'ws_KF05', 'ws_KF44', 'ws_KF46', 'ws_KFST', 'ws_KFTN', 'ws_KFTW', 'ws_KFWS', 'ws_KGDJ', 'ws_KGDP', 'ws_KGGG', 'ws_KGKY', 'ws_KGLE', 'ws_KGLS', 'ws_KGNC', 'ws_KGOP', 'ws_KGPM', 'ws_KGRK', 'ws_KGTU', 'ws_KGUL', 'ws_KGVT', 'ws_KGVX', 'ws_KGYB', 'ws_KGYI', 'ws_KHBV', 'ws_KHDO', 'ws_KHHF', 'ws_KHHV', 'ws_KHLR', 'ws_KHOU', 'ws_KHQI', 'ws_KHQZ', 'ws_KHRL', 'ws_KHRX', 'ws_KHYI', 'ws_KIAH', 'ws_KILE', 'ws_KINJ', 'ws_KINK', 'ws_KJAS', 'ws_KJCT', 'ws_KJDD', 'ws_KJSO', 'ws_KJWY', 'ws_KJXI', 'ws_KLBB', 'ws_KLBR', 'ws_KLBX', 'ws_KLFK', 'ws_KLHB', 'ws_KLNC', 'ws_KLRD', 'ws_KLUD', 'ws_KLVJ', 'ws_KLXY', 'ws_KLZZ', 'ws_KMAF', 'ws_KMCJ', 'ws_KMDD', 'ws_KMFE', 'ws_KMKN', 'ws_KMNZ', 'ws_KMRF', 'ws_KMWL', 'ws_KMZG', 'ws_KNFW', 'ws_KNGP', 'ws_KNOG', 'ws_KNQI', 'ws_KOCH', 'ws_KODO', 'ws_KORG', 'ws_KOSA', 'ws_KOZA', 'ws_KPEQ', 'ws_KPEZ', 'ws_KPIL', 'ws_KPKV', 'ws_KPPA', 'ws_KPRS', 'ws_KPRX', 'ws_KPSN', 'ws_KPSX', 'ws_KPVW', 'ws_KPWG', 'ws_KPYX', 'ws_KRAS', 'ws_KRBD', 'ws_KRBO', 'ws_KRFI', 'ws_KRKP', 'ws_KRND', 'ws_KRPH', 'ws_KRWV', 'ws_KRYW', 'ws_KSAT', 'ws_KSEP', 'ws_KSGR', 'ws_KSJT', 'ws_KSKF', 'ws_KSLR', 'ws_KSNK', 'ws_KSOA', 'ws_KSPL', 'ws_KSPS', 'ws_KSSF', 'ws_KSWW', 'ws_KT35', 'ws_KT65', 'ws_KT82', 'ws_KTFP', 'ws_KTKI', 'ws_KTME', 'ws_KTPL', 'ws_KTRL', 'ws_KTYR', 'ws_KUTS', 'ws_KUVA', 'ws_KVCT', 'ws_KXBP', 'ws_KXIH', 'roll_ws_K11R_3_-1', 'roll_ws_K3T5_3_-1', 'roll_ws_K6R6_3_-1', 'roll_ws_KABI_3_-1', 'roll_ws_KACT_3_-1', 'roll_ws_KADS_3_-1', 'roll_ws_KAFW_3_-1', 'roll_ws_KALI_3_-1', 'roll_ws_KAMA_3_-1', 'roll_ws_KAPY_3_-1', 'roll_ws_KAQO_3_-1', 'roll_ws_KARM_3_-1', 'roll_ws_KASL_3_-1', 'roll_ws_KATT_3_-1', 'roll_ws_KAUS_3_-1', 'roll_ws_KAXH_3_-1', 'roll_ws_KBAZ_3_-1', 'roll_ws_KBBD_3_-1', 'roll_ws_KBBF_3_-1', 'roll_ws_KBEA_3_-1', 'roll_ws_KBGD_3_-1', 'roll_ws_KBIF_3_-1', 'roll_ws_KBKD_3_-1', 'roll_ws_KBKS_3_-1', 'roll_ws_KBMQ_3_-1', 'roll_ws_KBMT_3_-1', 'roll_ws_KBPC_3_-1', 'roll_ws_KBPG_3_-1', 'roll_ws_KBPT_3_-1', 'roll_ws_KBQX_3_-1', 'roll_ws_KBRO_3_-1', 'roll_ws_KBWD_3_-1', 'roll_ws_KBYY_3_-1', 'roll_ws_KCDS_3_-1', 'roll_ws_KCLL_3_-1', 'roll_ws_KCNW_3_-1', 'roll_ws_KCOM_3_-1', 'roll_ws_KCOT_3_-1', 'roll_ws_KCPT_3_-1', 'roll_ws_KCRH_3_-1', 'roll_ws_KCRP_3_-1', 'roll_ws_KCRS_3_-1', 'roll_ws_KCWC_3_-1', 'roll_ws_KCXO_3_-1', 'roll_ws_KDAL_3_-1', 'roll_ws_KDFW_3_-1', 'roll_ws_KDHT_3_-1', 'roll_ws_KDKR_3_-1', 'roll_ws_KDLF_3_-1', 'roll_ws_KDRT_3_-1', 'roll_ws_KDTO_3_-1', 'roll_ws_KDUX_3_-1', 'roll_ws_KDWH_3_-1', 'roll_ws_KDYS_3_-1', 'roll_ws_KDZB_3_-1', 'roll_ws_KE38_3_-1', 'roll_ws_KEBG_3_-1', 'roll_ws_KECU_3_-1', 'roll_ws_KEDC_3_-1', 'roll_ws_KEFD_3_-1', 'roll_ws_KELP_3_-1', 'roll_ws_KEMK_3_-1', 'roll_ws_KERV_3_-1', 'roll_ws_KF05_3_-1', 'roll_ws_KF44_3_-1', 'roll_ws_KF46_3_-1', 'roll_ws_KFST_3_-1', 'roll_ws_KFTN_3_-1', 'roll_ws_KFTW_3_-1', 'roll_ws_KFWS_3_-1', 'roll_ws_KGDJ_3_-1', 'roll_ws_KGDP_3_-1', 'roll_ws_KGGG_3_-1', 'roll_ws_KGKY_3_-1', 'roll_ws_KGLE_3_-1', 'roll_ws_KGLS_3_-1', 'roll_ws_KGNC_3_-1', 'roll_ws_KGOP_3_-1', 'roll_ws_KGPM_3_-1', 'roll_ws_KGRK_3_-1', 'roll_ws_KGTU_3_-1', 'roll_ws_KGUL_3_-1', 'roll_ws_KGVT_3_-1', 'roll_ws_KGVX_3_-1', 'roll_ws_KGYB_3_-1', 'roll_ws_KGYI_3_-1', 'roll_ws_KHBV_3_-1', 'roll_ws_KHDO_3_-1', 'roll_ws_KHHF_3_-1', 'roll_ws_KHHV_3_-1', 'roll_ws_KHLR_3_-1', 'roll_ws_KHOU_3_-1', 'roll_ws_KHQI_3_-1', 'roll_ws_KHQZ_3_-1', 'roll_ws_KHRL_3_-1', 'roll_ws_KHRX_3_-1', 'roll_ws_KHYI_3_-1', 'roll_ws_KIAH_3_-1', 'roll_ws_KILE_3_-1', 'roll_ws_KINJ_3_-1', 'roll_ws_KINK_3_-1', 'roll_ws_KJAS_3_-1', 'roll_ws_KJCT_3_-1', 'roll_ws_KJDD_3_-1', 'roll_ws_KJSO_3_-1', 'roll_ws_KJWY_3_-1', 'roll_ws_KJXI_3_-1', 'roll_ws_KLBB_3_-1', 'roll_ws_KLBR_3_-1', 'roll_ws_KLBX_3_-1', 'roll_ws_KLFK_3_-1', 'roll_ws_KLHB_3_-1', 'roll_ws_KLNC_3_-1', 'roll_ws_KLRD_3_-1', 'roll_ws_KLUD_3_-1', 'roll_ws_KLVJ_3_-1', 'roll_ws_KLXY_3_-1', 'roll_ws_KLZZ_3_-1', 'roll_ws_KMAF_3_-1', 'roll_ws_KMCJ_3_-1', 'roll_ws_KMDD_3_-1', 'roll_ws_KMFE_3_-1', 'roll_ws_KMKN_3_-1', 'roll_ws_KMNZ_3_-1', 'roll_ws_KMRF_3_-1', 'roll_ws_KMWL_3_-1', 'roll_ws_KMZG_3_-1', 'roll_ws_KNFW_3_-1', 'roll_ws_KNGP_3_-1', 'roll_ws_KNOG_3_-1', 'roll_ws_KNQI_3_-1', 'roll_ws_KOCH_3_-1', 'roll_ws_KODO_3_-1', 'roll_ws_KORG_3_-1', 'roll_ws_KOSA_3_-1', 'roll_ws_KOZA_3_-1', 'roll_ws_KPEQ_3_-1', 'roll_ws_KPEZ_3_-1', 'roll_ws_KPIL_3_-1', 'roll_ws_KPKV_3_-1', 'roll_ws_KPPA_3_-1', 'roll_ws_KPRS_3_-1', 'roll_ws_KPRX_3_-1', 'roll_ws_KPSN_3_-1', 'roll_ws_KPSX_3_-1', 'roll_ws_KPVW_3_-1', 'roll_ws_KPWG_3_-1', 'roll_ws_KPYX_3_-1', 'roll_ws_KRAS_3_-1', 'roll_ws_KRBD_3_-1', 'roll_ws_KRBO_3_-1', 'roll_ws_KRFI_3_-1', 'roll_ws_KRKP_3_-1', 'roll_ws_KRND_3_-1', 'roll_ws_KRPH_3_-1', 'roll_ws_KRWV_3_-1', 'roll_ws_KRYW_3_-1', 'roll_ws_KSAT_3_-1', 'roll_ws_KSEP_3_-1', 'roll_ws_KSGR_3_-1', 'roll_ws_KSJT_3_-1', 'roll_ws_KSKF_3_-1', 'roll_ws_KSLR_3_-1', 'roll_ws_KSNK_3_-1', 'roll_ws_KSOA_3_-1', 'roll_ws_KSPL_3_-1', 'roll_ws_KSPS_3_-1', 'roll_ws_KSSF_3_-1', 'roll_ws_KSWW_3_-1', 'roll_ws_KT35_3_-1', 'roll_ws_KT65_3_-1', 'roll_ws_KT82_3_-1', 'roll_ws_KTFP_3_-1', 'roll_ws_KTKI_3_-1', 'roll_ws_KTME_3_-1', 'roll_ws_KTPL_3_-1', 'roll_ws_KTRL_3_-1', 'roll_ws_KTYR_3_-1', 'roll_ws_KUTS_3_-1', 'roll_ws_KUVA_3_-1', 'roll_ws_KVCT_3_-1', 'roll_ws_KXBP_3_-1', 'roll_ws_KXIH_3_-1', 'roll_ws_K11R_5_-2', 'roll_ws_K3T5_5_-2', 'roll_ws_K6R6_5_-2', 'roll_ws_KABI_5_-2', 'roll_ws_KACT_5_-2', 'roll_ws_KADS_5_-2', 'roll_ws_KAFW_5_-2', 'roll_ws_KALI_5_-2', 'roll_ws_KAMA_5_-2', 'roll_ws_KAPY_5_-2', 'roll_ws_KAQO_5_-2', 'roll_ws_KARM_5_-2', 'roll_ws_KASL_5_-2', 'roll_ws_KATT_5_-2', 'roll_ws_KAUS_5_-2', 'roll_ws_KAXH_5_-2', 'roll_ws_KBAZ_5_-2', 'roll_ws_KBBD_5_-2', 'roll_ws_KBBF_5_-2', 'roll_ws_KBEA_5_-2', 'roll_ws_KBGD_5_-2', 'roll_ws_KBIF_5_-2', 'roll_ws_KBKD_5_-2', 'roll_ws_KBKS_5_-2', 'roll_ws_KBMQ_5_-2', 'roll_ws_KBMT_5_-2', 'roll_ws_KBPC_5_-2', 'roll_ws_KBPG_5_-2', 'roll_ws_KBPT_5_-2', 'roll_ws_KBQX_5_-2', 'roll_ws_KBRO_5_-2', 'roll_ws_KBWD_5_-2', 'roll_ws_KBYY_5_-2', 'roll_ws_KCDS_5_-2', 'roll_ws_KCLL_5_-2', 'roll_ws_KCNW_5_-2', 'roll_ws_KCOM_5_-2', 'roll_ws_KCOT_5_-2', 'roll_ws_KCPT_5_-2', 'roll_ws_KCRH_5_-2', 'roll_ws_KCRP_5_-2', 'roll_ws_KCRS_5_-2', 'roll_ws_KCWC_5_-2', 'roll_ws_KCXO_5_-2', 'roll_ws_KDAL_5_-2', 'roll_ws_KDFW_5_-2', 'roll_ws_KDHT_5_-2', 'roll_ws_KDKR_5_-2', 'roll_ws_KDLF_5_-2', 'roll_ws_KDRT_5_-2', 'roll_ws_KDTO_5_-2', 'roll_ws_KDUX_5_-2', 'roll_ws_KDWH_5_-2', 'roll_ws_KDYS_5_-2', 'roll_ws_KDZB_5_-2', 'roll_ws_KE38_5_-2', 'roll_ws_KEBG_5_-2', 'roll_ws_KECU_5_-2', 'roll_ws_KEDC_5_-2', 'roll_ws_KEFD_5_-2', 'roll_ws_KELP_5_-2', 'roll_ws_KEMK_5_-2', 'roll_ws_KERV_5_-2', 'roll_ws_KF05_5_-2', 'roll_ws_KF44_5_-2', 'roll_ws_KF46_5_-2', 'roll_ws_KFST_5_-2', 'roll_ws_KFTN_5_-2', 'roll_ws_KFTW_5_-2', 'roll_ws_KFWS_5_-2', 'roll_ws_KGDJ_5_-2', 'roll_ws_KGDP_5_-2', 'roll_ws_KGGG_5_-2', 'roll_ws_KGKY_5_-2', 'roll_ws_KGLE_5_-2', 'roll_ws_KGLS_5_-2', 'roll_ws_KGNC_5_-2', 'roll_ws_KGOP_5_-2', 'roll_ws_KGPM_5_-2', 'roll_ws_KGRK_5_-2', 'roll_ws_KGTU_5_-2', 'roll_ws_KGUL_5_-2', 'roll_ws_KGVT_5_-2', 'roll_ws_KGVX_5_-2', 'roll_ws_KGYB_5_-2', 'roll_ws_KGYI_5_-2', 'roll_ws_KHBV_5_-2', 'roll_ws_KHDO_5_-2', 'roll_ws_KHHF_5_-2', 'roll_ws_KHHV_5_-2', 'roll_ws_KHLR_5_-2', 'roll_ws_KHOU_5_-2', 'roll_ws_KHQI_5_-2', 'roll_ws_KHQZ_5_-2', 'roll_ws_KHRL_5_-2', 'roll_ws_KHRX_5_-2', 'roll_ws_KHYI_5_-2', 'roll_ws_KIAH_5_-2', 'roll_ws_KILE_5_-2', 'roll_ws_KINJ_5_-2', 'roll_ws_KINK_5_-2', 'roll_ws_KJAS_5_-2', 'roll_ws_KJCT_5_-2', 'roll_ws_KJDD_5_-2', 'roll_ws_KJSO_5_-2', 'roll_ws_KJWY_5_-2', 'roll_ws_KJXI_5_-2', 'roll_ws_KLBB_5_-2', 'roll_ws_KLBR_5_-2', 'roll_ws_KLBX_5_-2', 'roll_ws_KLFK_5_-2', 'roll_ws_KLHB_5_-2', 'roll_ws_KLNC_5_-2', 'roll_ws_KLRD_5_-2', 'roll_ws_KLUD_5_-2', 'roll_ws_KLVJ_5_-2', 'roll_ws_KLXY_5_-2', 'roll_ws_KLZZ_5_-2', 'roll_ws_KMAF_5_-2', 'roll_ws_KMCJ_5_-2', 'roll_ws_KMDD_5_-2', 'roll_ws_KMFE_5_-2', 'roll_ws_KMKN_5_-2', 'roll_ws_KMNZ_5_-2', 'roll_ws_KMRF_5_-2', 'roll_ws_KMWL_5_-2', 'roll_ws_KMZG_5_-2', 'roll_ws_KNFW_5_-2', 'roll_ws_KNGP_5_-2', 'roll_ws_KNOG_5_-2', 'roll_ws_KNQI_5_-2', 'roll_ws_KOCH_5_-2', 'roll_ws_KODO_5_-2', 'roll_ws_KORG_5_-2', 'roll_ws_KOSA_5_-2', 'roll_ws_KOZA_5_-2', 'roll_ws_KPEQ_5_-2', 'roll_ws_KPEZ_5_-2', 'roll_ws_KPIL_5_-2', 'roll_ws_KPKV_5_-2', 'roll_ws_KPPA_5_-2', 'roll_ws_KPRS_5_-2', 'roll_ws_KPRX_5_-2', 'roll_ws_KPSN_5_-2', 'roll_ws_KPSX_5_-2', 'roll_ws_KPVW_5_-2', 'roll_ws_KPWG_5_-2', 'roll_ws_KPYX_5_-2', 'roll_ws_KRAS_5_-2', 'roll_ws_KRBD_5_-2', 'roll_ws_KRBO_5_-2', 'roll_ws_KRFI_5_-2', 'roll_ws_KRKP_5_-2', 'roll_ws_KRND_5_-2', 'roll_ws_KRPH_5_-2', 'roll_ws_KRWV_5_-2', 'roll_ws_KRYW_5_-2', 'roll_ws_KSAT_5_-2', 'roll_ws_KSEP_5_-2', 'roll_ws_KSGR_5_-2', 'roll_ws_KSJT_5_-2', 'roll_ws_KSKF_5_-2', 'roll_ws_KSLR_5_-2', 'roll_ws_KSNK_5_-2', 'roll_ws_KSOA_5_-2', 'roll_ws_KSPL_5_-2', 'roll_ws_KSPS_5_-2', 'roll_ws_KSSF_5_-2', 'roll_ws_KSWW_5_-2', 'roll_ws_KT35_5_-2', 'roll_ws_KT65_5_-2', 'roll_ws_KT82_5_-2', 'roll_ws_KTFP_5_-2', 'roll_ws_KTKI_5_-2', 'roll_ws_KTME_5_-2', 'roll_ws_KTPL_5_-2', 'roll_ws_KTRL_5_-2', 'roll_ws_KTYR_5_-2', 'roll_ws_KUTS_5_-2', 'roll_ws_KUVA_5_-2', 'roll_ws_KVCT_5_-2', 'roll_ws_KXBP_5_-2', 'roll_ws_KXIH_5_-2', 'T_KIAH', 'T_KSAT', 'T_KDFW', 'T_KSPS', 'T_KPRX', 'T_KACT', 'T_KLFK', 'T_KBRO', 'T_KCRP', 'T_KGLS', 'T_KAUS', 'T_KSJT', 'T_KMAF', 'T_KABI', 'T_KTYR', 'T_KINK', 'T_KIAH-T_KSAT', 'T_KIAH-T_KDFW', 'T_KIAH-T_KSPS', 'T_KIAH-T_KPRX', 'T_KIAH-T_KACT', 'T_KIAH-T_KLFK', 'T_KIAH-T_KBRO', 'T_KIAH-T_KCRP', 'T_KIAH-T_KGLS', 'T_KIAH-T_KAUS', 'T_KIAH-T_KSJT', 'T_KIAH-T_KMAF', 'T_KIAH-T_KABI', 'T_KIAH-T_KTYR', 'T_KIAH-T_KINK', 'T_KSAT-T_KDFW', 'T_KSAT-T_KSPS', 'T_KSAT-T_KPRX', 'T_KSAT-T_KACT', 'T_KSAT-T_KLFK', 'T_KSAT-T_KBRO', 'T_KSAT-T_KCRP', 'T_KSAT-T_KGLS', 'T_KSAT-T_KAUS', 'T_KSAT-T_KSJT', 'T_KSAT-T_KMAF', 'T_KSAT-T_KABI', 'T_KSAT-T_KTYR', 'T_KSAT-T_KINK', 'T_KDFW-T_KSPS', 'T_KDFW-T_KPRX', 'T_KDFW-T_KACT', 'T_KDFW-T_KLFK', 'T_KDFW-T_KBRO', 'T_KDFW-T_KCRP', 'T_KDFW-T_KGLS', 'T_KDFW-T_KAUS', 'T_KDFW-T_KSJT', 'T_KDFW-T_KMAF', 'T_KDFW-T_KABI', 'T_KDFW-T_KTYR', 'T_KDFW-T_KINK', 'T_KSPS-T_KPRX', 'T_KSPS-T_KACT', 'T_KSPS-T_KLFK', 'T_KSPS-T_KBRO', 'T_KSPS-T_KCRP', 'T_KSPS-T_KGLS', 'T_KSPS-T_KAUS', 'T_KSPS-T_KSJT', 'T_KSPS-T_KMAF', 'T_KSPS-T_KABI', 'T_KSPS-T_KTYR', 'T_KSPS-T_KINK', 'T_KPRX-T_KACT', 'T_KPRX-T_KLFK', 'T_KPRX-T_KBRO', 'T_KPRX-T_KCRP', 'T_KPRX-T_KGLS', 'T_KPRX-T_KAUS', 'T_KPRX-T_KSJT', 'T_KPRX-T_KMAF', 'T_KPRX-T_KABI', 'T_KPRX-T_KTYR', 'T_KPRX-T_KINK', 'T_KACT-T_KLFK', 'T_KACT-T_KBRO', 'T_KACT-T_KCRP', 'T_KACT-T_KGLS', 'T_KACT-T_KAUS', 'T_KACT-T_KSJT', 'T_KACT-T_KMAF', 'T_KACT-T_KABI', 'T_KACT-T_KTYR', 'T_KACT-T_KINK', 'T_KLFK-T_KBRO', 'T_KLFK-T_KCRP', 'T_KLFK-T_KGLS', 'T_KLFK-T_KAUS', 'T_KLFK-T_KSJT', 'T_KLFK-T_KMAF', 'T_KLFK-T_KABI', 'T_KLFK-T_KTYR', 'T_KLFK-T_KINK', 'T_KBRO-T_KCRP', 'T_KBRO-T_KGLS', 'T_KBRO-T_KAUS', 'T_KBRO-T_KSJT', 'T_KBRO-T_KMAF', 'T_KBRO-T_KABI', 'T_KBRO-T_KTYR', 'T_KBRO-T_KINK', 'T_KCRP-T_KGLS', 'T_KCRP-T_KAUS', 'T_KCRP-T_KSJT', 'T_KCRP-T_KMAF', 'T_KCRP-T_KABI', 'T_KCRP-T_KTYR', 'T_KCRP-T_KINK', 'T_KGLS-T_KAUS', 'T_KGLS-T_KSJT', 'T_KGLS-T_KMAF', 'T_KGLS-T_KABI', 'T_KGLS-T_KTYR', 'T_KGLS-T_KINK', 'T_KAUS-T_KSJT', 'T_KAUS-T_KMAF', 'T_KAUS-T_KABI', 'T_KAUS-T_KTYR', 'T_KAUS-T_KINK', 'T_KSJT-T_KMAF', 'T_KSJT-T_KABI', 'T_KSJT-T_KTYR', 'T_KSJT-T_KINK', 'T_KMAF-T_KABI', 'T_KMAF-T_KTYR', 'T_KMAF-T_KINK', 'T_KABI-T_KTYR', 
                  'T_KABI-T_KINK', 'T_KTYR-T_KINK']




grid_1 = {
    'learning_rate': [0.0001, 0.001, 0.01, 0.1],
    'depth':[4, 6, 10],
    'bagging_temperature': [0, .2, .5,  1, 2]}

cb_model = CatBoostRegressor(iterations=5000,
                              eval_metric='MAE',
                                 random_seed = 33,
                                 task_type='GPU', 
                                 border_count=36,
                                 od_wait=50)

grid_search_results = cb_model.grid_search(grid_1, data_trn[used_feature_lgb], data_trn[target], verbose=3)
grid_search_results['params']
grid_search_results['cv_results'].keys()
grid_search_results['cv_results']['test-Logloss-mean'][-1]


import seaborn as sns
import matplotlib.pyplot as plt
fea_imp = pd.DataFrame({'imp': cb_model.feature_importances_, 'col': used_feature_lgb}) #X.columns
fea_imp = fea_imp.sort_values(['imp', 'col'], ascending=[True, False]).iloc[-30:]
fea_imp.plot(kind='barh', x='col', y='imp', figsize=(10, 7), legend=None)
plt.title('CatBoost - Feature Importance')
plt.ylabel('Features')
plt.xlabel('Importance');